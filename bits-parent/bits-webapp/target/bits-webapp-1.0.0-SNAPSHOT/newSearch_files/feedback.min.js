$(document).ready(function(){$("#txtFeedbackEmail").emailtip();$("#feedback").click(function(){$(".layer-bg").show();$("#divfeedback").show()});$("#feedbackClose,#btnFeedbackClose").click(function(){$(".layer-bg").hide();$("#divfeedback").hide()});$("#btnVerifyCode,#imgVerifyCode").click(function(){$("#imgVerifyCode").attr("src","/ajax/getauthcode.ashx?"+(+new Date));$("#txtFeedbackVerifyCode").val("").focus()})});function checkVerifyCode(){var a=$("#txtFeedbackVerifyCode").val().trim();if(a==""){$("#divFeedbackError").html("请输入验证码！");return false}if(a.length>5){$("#divFeedbackError").html("输入的字符过长。请重新录入");return false}return true}function checkEmail(){var a=$("#txtFeedbackEmail").val().trim();if(a==""){$("#divFeedbackError").html("邮箱不能为空，请填写您的真实邮箱！");return false}else{var b=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;if(!b.test(a)){$("#divFeedbackError").html("您输入的邮箱格式错误，请重新输入！");return false}}if(a.length>100){$("#divFeedbackError").html("输入的字符过长。请重新录入");return false}$("#divFeedbackError").html("");return true}function checkTitle(){var a=$("#txtFeedbackTitle").val().trim();if(a==""){$("#divFeedbackError").html("标题不能为空！");return false}if(a.length>100){$("#divFeedbackError").html("输入的字符过长。请重新录入")}return true}function checkDescription(){var a=$("#txtFeedbackDescription").val().trim();if(a==""){$("#divFeedbackError").html("反馈意见不能为空！");return false}if(a.length>500){$("#divFeedbackError").html("输入的字符过长。请重新录入")}return true}function feedback(){$("#divFeedbackError").html("");if(!checkTitle()){$("#txtFeedbackTitle").focus();return false}if(!checkEmail()){$("#txtFeedbackEmail").focus();return false}if(!checkDescription()){$("#txtFeedbackDescription").focus();return false}if(!checkVerifyCode()){$("#txtFeedbackVerifyCode").focus();return false}$.getJSON("/ajax/UserFeedBackHandler.ashx",{Title:$("#txtFeedbackTitle").val(),Description:$("#txtFeedbackDescription").val(),Email:$("#txtFeedbackEmail").val(),Code:$("#txtFeedbackVerifyCode").val()},function(a){if(a.error){alert(a.error);return false}else{if(a.code){$("#imgVerifyCode").attr("src","/ajax/getauthcode.ashx?"+Math.random());$("#txtFeedbackVerifyCode").val("").focus();alert(a.code);return false}}$("#divfeedback").hide();$(".layer-bg").hide();alert("反馈意见已提交成功，感谢您的反馈！");$("#txtFeedbackEmail").val("");$("#txtFeedbackTitle").val("");$("#txtFeedbackDescription").val("");$("#imgVerifyCode").attr("src","/ajax/getauthcode.ashx?"+Math.random());$("#txtFeedbackVerifyCode").val("")})};